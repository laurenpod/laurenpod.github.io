"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4354],{94354:function(e,t,n){n.d(t,{$H:function(){return U},$Y:function(){return S},CJ:function(){return A},Gk:function(){return R},Ke:function(){return D},Ls:function(){return B},OD:function(){return O},PD:function(){return I},QR:function(){return k},Rq:function(){return w},W:function(){return q},_C:function(){return Q},cj:function(){return X},f7:function(){return P},fc:function(){return N},gK:function(){return j},gm:function(){return z},hA:function(){return C},j1:function(){return x},j7:function(){return K},jl:function(){return W},o:function(){return y},rI:function(){return E},yj:function(){return T}});var r=n(6700),a=n(83041),i=n(16096),u=n(17179),o=n(31087),s=n(35146),l=n(36665),c=n(28505),d=n(84983),v=n(74822),_=n(11064),g=n.n(_),p=n(99733),m=n.n(p),f=n(54603),h=n(7653),b=n(50504);let y=(e,t)=>{let{activeOrganization:n}=(0,i.useCurrentAccount)(),r=null==n?void 0:n.uuid;return(0,a.WE)("/api/organizations/".concat(r,"/chat_conversations/").concat(e,"/chat_messages/").concat(t,"/debug"),{queryKey:[s.Ep,{orgUUID:r},{conversationUuid:e},{messageUuid:t}],enabled:!!t})},C=function(e){let{suppressError:t,enabled:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:r}=(0,i.useCurrentAccount)(),u=null==r?void 0:r.uuid;return(0,a.WE)("/api/organizations/".concat(null!=u?u:"","/chat_conversations/").concat(e),{queryKey:[s.ph,{orgUUID:u},{uuid:e}],staleTime:3e5,enabled:!!u&&!!e&&n,select:e=>({...e,chat_messages:m()(e.chat_messages,"index")}),meta:{noToast:t}})},w=e=>{let t=(0,d.useQueryClient)(),{activeOrganization:n}=(0,i.useCurrentAccount)(),r=null==n?void 0:n.uuid,[a,u]=(0,h.useReducer)(e=>e+1,0),o=(0,l.B)([s.I8,{orgUUID:r},{uuid:e}]),c=(0,h.useMemo)(()=>t.getQueryData(o),[t,o,e,a]);return(0,h.useEffect)(()=>t.getQueryCache().subscribe(e=>{"updated"===e.type&&"success"===e.action.type&&(0,v._x)({queryKey:o},e.query)&&u()}),[t,u,o]),{data:c}},k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,r=new URLSearchParams,{limit:u,offset:o}=e;void 0!==u&&r.append("limit",u.toString()),void 0!==o&&r.append("offset",o.toString());let l=r.toString();return l=l?"?".concat(l):"",(0,a.WE)("/api/organizations/".concat(null!=n?n:"","/chat_conversations").concat(l),{queryKey:[s.tv,{orgUUID:n},{limit:u,offset:o}],staleTime:3e5,enabled:!!n})},Q=function(e){let{suppressError:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,i.useCurrentAccount)(),r=(0,i.useUseMessagesApiGate)(),u=null==n?void 0:n.uuid,o=(0,h.useRef)([]),l="/api/organizations/".concat(null!=u?u:"","/chat_conversations/").concat(e,"?tree=True&rendering_mode=").concat(r?"messages":"raw"),c=(0,a.WE)(l,{queryKey:[s.I8,{orgUUID:u},{uuid:e}],staleTime:3e5,enabled:!!u&&!!e,meta:{noToast:t}},b.fX),d=(0,h.useMemo)(()=>{if(!c.data)return o.current=[],o.current;let e=(0,b.kX)(c.data);if(e.length!==o.current.length||e.some((e,t)=>{var n;return e.uuid!==(null===(n=o.current[t])||void 0===n?void 0:n.uuid)}))return o.current=e,o.current;for(let t=0;t<e.length;t++)g()(e[t],o.current[t])||(o.current[t]=e[t]);return o.current},[c.data]);return{...c,currentPath:d}},U=(e,t)=>{let{mutate:n}=S(),r=(0,f.useRouter)(),a=t||(0,c.H)();return(0,h.useCallback)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{model:void 0,controlsOpen:!1};n({uuid:a,name:"",model:t.model});let i="/chat/".concat(a).concat(t.controlsOpen?"?controls=1":"");r[e](i)},[n,r,e,a])},S=()=>{let{activeOrganization:e}=(0,i.useCurrentAccount)(),t=null==e?void 0:e.uuid,n=(0,d.useQueryClient)(),r=[s.tv,{orgUUID:t}],u=e=>[s.ph,{orgUUID:t},{uuid:e}],o=e=>[s.I8,{orgUUID:t},{uuid:e}];return(0,a.uC)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),"POST",{enabled:!!t,async onMutate(e){let t=u(e.uuid),a={summary:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),...e};await Promise.all([n.cancelQueries({queryKey:r}),n.cancelQueries({queryKey:t})]),n.setQueryData(r,e=>e&&[a,...e]),n.setQueryData(t,e=>({...e||{},...a,chat_messages:(null==e?void 0:e.chat_messages)||[]}))},onSuccess:e=>{n.setQueryData(r,t=>{if(!t)return;let n=t.findIndex(t=>t.uuid===e.uuid);if(-1===n)return t;let r=[...t];return r.splice(n,1,e),r}),n.setQueryData(o(e.uuid),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[],messageByUuid:new Map,parentByChildUuid:new Map,childrenByParentUuid:new Map,selectedChildByUuid:new Map})),H(n,t)},onError(e,t){n.setQueryData(r,e=>null==e?void 0:e.filter(e=>e.uuid!==t.uuid)),n.setQueryData(u(t.uuid),void 0)}})},x=()=>{let{activeOrganization:e}=(0,i.useCurrentAccount)(),t=null==e?void 0:e.uuid,n=(0,d.useQueryClient)();return(0,a.Ne)(e=>"/api/organizations/".concat(null!=t?t:"","/chat_conversations/").concat(e),"DELETE",(e,t)=>{if(!t)return[];let n=t.findIndex(t=>t.uuid===e);if(!(n>-1))return t;{let e=[...t];return e.splice(n,1),e}},{enabled:!!t,queryKey:[s.tv,{orgUUID:t}],onSuccess:async(e,r)=>{await n.invalidateQueries([s.I8,{orgUUID:t},{uuid:r}]),await H(n,t)}})},P=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,r=(0,d.useQueryClient)();return(0,a.Ne)("/api/organizations/".concat(n,"/chat_conversations/delete_many"),"POST",(e,t)=>t?t.filter(t=>!e.conversation_uuids.includes(t.uuid)):[],{onSuccess:async t=>{await H(r,n),e&&e(t)},queryKey:[s.tv,{orgUUID:n}]})},T=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,r=null==t?void 0:t.capabilities.includes("raven");return(0,a.WE)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/shares"),{queryKey:[s.zb,{orgUUID:n,conversationUUID:e}],enabled:!!n&&r,staleTime:3e5})},z=()=>{let{activeOrganization:e}=(0,i.useCurrentAccount)(),t=null==e?void 0:e.uuid,n=null==e?void 0:e.capabilities.includes("raven");return(0,a.WE)("/api/organizations/".concat(t,"/shares"),{queryKey:[s.PB,{orgUUID:t}],enabled:!!t&&n,staleTime:3e5})},A=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,r=(0,i.useUseMessagesApiGate)();return(0,a.WE)("/api/organizations/".concat(n,"/chat_snapshots/").concat(e,"?rendering_mode=").concat(r?"messages":"raw"),{retry:!1,refetchInterval:!1,enabled:!!e,staleTime:0,queryKey:[s.ld,{orgUUID:n,snapshotUUID:e}]},e=>({...e,chat_messages:e.chat_messages.map(e=>(0,b.Dk)(e))}))},I=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid,r=(0,d.useQueryClient)(),{data:u}=w(e);return(0,a.Ne)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/share"),"POST",(e,t)=>{let n=null==u?void 0:u.chat_messages.findIndex(e=>e.uuid===(null==u?void 0:u.current_leaf_message_uuid));if(!n)return t;let r={uuid:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),snapshot_name:null==u?void 0:u.name,last_message_index:n,...e};return t?[...t,r]:[r]},{onSuccess:t=>{r.invalidateQueries([s.zb,{orgUUID:n,conversationUUID:e}]),r.invalidateQueries([s.PB,{orgUUID:n}]),r.invalidateQueries([s.ld,{orgUUID:n,snapshotUUID:t.uuid}]),r.invalidateQueries([s.VH,{orgUUID:n}])},queryKey:[s.zb,{orgUUID:n,conversationUUID:e}],meta:{errorMessage:"There was an error while trying to share the conversation. Please try again."}})},B=(e,t)=>{let{activeOrganization:n}=(0,i.useCurrentAccount)(),r=null==n?void 0:n.uuid,u=(0,d.useQueryClient)();return(0,a.Ne)("/api/organizations/".concat(r,"/share/").concat(t),"DELETE",(e,n)=>{if(!n)return[];let r=n.findIndex(e=>e.uuid===t);if(!(r>-1))return n;{let e=[...n];return e.splice(r,1),e}},{enabled:!!r,queryKey:[s.zb,{orgUUID:r,conversationUUID:e}],onSuccess:()=>{u.invalidateQueries([s.zb,{orgUUID:r,conversationUUID:e}]),u.invalidateQueries([s.PB,{orgUUID:r}]),u.invalidateQueries([s.ld,{orgUUID:r,snapshotUUID:t}]),u.invalidateQueries([s.VH,{orgUUID:r}])},meta:{errorMessage:"There was an error while trying to unshare the conversation. Please try again."}})},D=(e,t,n)=>{var o,l,c;let{track:v}=(0,r.z$)(),_=null!==(l=null===(o=(0,u.T)())||void 0===o?void 0:o.preview_feature_uses_artifacts)&&void 0!==l&&l,{activeOrganization:g}=(0,i.useCurrentAccount)(),p=null==g?void 0:g.uuid,m=(0,d.useQueryClient)(),f=[s.I8,{orgUUID:p},{uuid:e}];return(0,a.uC)("/api/organizations/".concat(null!=p?p:"","/chat_conversations/").concat(e,"/chat_messages/").concat(null!==(c=t.uuid)&&void 0!==c?c:"","/chat_feedback"),t.chat_feedback?"PUT":"POST",{enabled:!!p,meta:{errorMessage:"We could not save your feedback. Please try again later."},onSuccess(){var r;v({event_key:"claudeai.conversation.feedback.sent",message_uuid:t.uuid,conversation_uuid:e,artifacts_enabled:_,conversationHasArtifacts:n,type:null===(r=t.chat_feedback)||void 0===r?void 0:r.type}),m.invalidateQueries(f)}})},E=()=>{let{activeOrganization:e}=(0,i.useCurrentAccount)(),t=null==e?void 0:e.uuid;return(0,a.uC)("/api/organizations/".concat(null!=t?t:"","/hfi/store_preference"),"POST",{enabled:!!t,meta:{errorMessage:"We could not save your feedback. Please try again later."}})},M=()=>{let e=(0,d.useQueryClient)(),{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,h.useCallback)((t,r)=>{t&&(e.setQueryData([s.I8,{orgUUID:n},{uuid:t}],e=>e&&{...e,...r}),e.setQueriesData([s.tv,{orgUUID:n}],e=>null==e?void 0:e.map(e=>e.uuid!==t?e:{...e,...r})))},[n,e])},q=e=>{let t=(0,d.useQueryClient)(),{activeOrganization:n}=(0,i.useCurrentAccount)(),r=null==n?void 0:n.uuid,u=M();return(0,a.uC)("/api/organizations/".concat(r,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{var a;let{name:i}=n,o=t.getQueryData([s.I8,{orgUUID:r},{uuid:e}]);return u(e,{name:i}),{oldTitle:null!==(a=null==o?void 0:o.name)&&void 0!==a?a:""}},onError(t,n,r){r&&u(e,{name:r.oldTitle})}})},K=e=>{let t=M(),{activeOrganization:n}=(0,i.useCurrentAccount)();return(0,a.uC)("/api/organizations/".concat(null==n?void 0:n.uuid,"/chat_conversations/").concat(e,"/title"),"POST",{onSuccess(n){let{title:r}=n;t(e,{name:null!=r?r:""})},meta:{noToast:!0}})};function O(e){var t,n;let r=(0,o.K)(e);return r+" "+e.attachments.map(e=>e.extracted_content).join(" ")+" "+((null===(t=e.content)||void 0===t?void 0:t.filter(e=>"tool_use"===e.type).map(e=>e.input?JSON.stringify(e.input):e.partial_json||"").join(" "))||"")+" "+((null===(n=e.content)||void 0===n?void 0:n.filter(e=>"tool_result"===e.type).flatMap(e=>e.content.filter(e=>"text"===e.type).map(e=>e.text)).join(" "))||"")}let j=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,a.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/stop_response"),"POST")},N=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,a.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/tool_result"),"POST",{enabled:!!n,meta:{errorMessage:"We could not record the tool result. Please try again later."}})},W=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=null==t?void 0:t.uuid;return(0,a.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/current_leaf_message_uuid"),"PUT")},H=async(e,t)=>{await e.invalidateQueries([s.tv,{orgUUID:t}])},R=e=>{let{activeOrganization:t}=(0,i.useCurrentAccount)(),n=(0,d.useQueryClient)(),r=null==t?void 0:t.uuid;return(0,a.Ne)("/api/organizations/".concat(r,"/chat_conversations/").concat(e,"?rendering_mode=raw"),"PUT",(e,t)=>t?{...t,...e}:void 0,{onSuccess:()=>{H(n,r)},queryKey:[s.I8,{orgUUID:r},{uuid:e}]})},X=()=>{let{data:e,isLoading:t}=k();return{data:null==e?void 0:e.filter(e=>e.is_starred),isLoading:t}}},50504:function(e,t,n){n.d(t,{Dk:function(){return d},FC:function(){return u},HX:function(){return g},QC:function(){return s},fX:function(){return _},kX:function(){return m},mj:function(){return f},vv:function(){return p},wZ:function(){return o}});var r=n(43316),a=n(88253),i=n.n(a);let u="new-assistant-message-uuid",o="new-human-message-uuid",s="00000000-0000-4000-8000-000000000000";function l(e,t){let n=e.get(t);if(void 0===n){let e=Error("Key not found: ".concat(t));throw(0,r.Tb)(e),e}return n}let c=(e,t)=>{let n=null!=t?t:e.current_leaf_message_uuid;if(!n)return e;for(;n!==s;){var r;let t=l(e.parentByChildUuid,n),a=null===(r=l(e.childrenByParentUuid,t))||void 0===r?void 0:r.indexOf(n);e.selectedChildByUuid.set(t,a),n=t}return{...e,current_leaf_message_uuid:t}},d=e=>e.content?e:{...e,content:[{type:"text",text:e.text||""}]},v=e=>{var t,n,r;let a=new Map,i=new Map,u=new Map,o=new Map,l=new Map;if(0===e.chat_messages.length)return{messageByUuid:i,parentByChildUuid:u,childrenByParentUuid:o,selectedChildByUuid:l};let c=e.chat_messages.map(d);for(let e of c)a.set(e.index,e),i.set(e.uuid,e);for(let e of c){let t=e.parent_message_uuid;if(!t){let r=e.index-1;for(;!t&&r>=0;)t=null===(n=a.get(r))||void 0===n?void 0:n.uuid,r--}t=null!=t?t:s,u.set(e.uuid,t),o.set(t,(null!==(r=o.get(t))&&void 0!==r?r:[]).concat(e.uuid)),l.set(t,0)}if(!(null===(t=o.get(s))||void 0===t?void 0:t[0]))throw Error("No root message found");return{chat_messages:c,messageByUuid:i,parentByChildUuid:u,childrenByParentUuid:o,selectedChildByUuid:l}},_=e=>{let t={...e,...v(e)};return t.current_leaf_message_uuid||c(t),c(t,e.current_leaf_message_uuid)},g=e=>{let t=Array.from(e.messageByUuid.values()).map(e=>e.index);return 0===t.length?-1:Math.max(...t)},p=(e,t)=>{for(let r of(e.chat_messages=e.chat_messages.concat(t),t)){var n;if(!r.parent_message_uuid)throw Error("Parent UUID required");let t=r.parent_message_uuid;e.messageByUuid.set(r.uuid,r),e.parentByChildUuid.set(r.uuid,t);let a=null!==(n=e.childrenByParentUuid.get(t))&&void 0!==n?n:[];a.push(r.uuid),e.childrenByParentUuid.set(t,a),e.selectedChildByUuid.set(t,a.length-1)}return c(e,t[t.length-1].uuid)},m=(e,t)=>{let n=[],r=null!=t?t:s;for(;e.childrenByParentUuid.has(r);){let t=l(e.childrenByParentUuid,r);if(0===t.length)break;let a=l(e.selectedChildByUuid,r),i=l(e.messageByUuid,t[a]);n.push({...i,parent_message_uuid:r,nOptions:t.length,selectedOption:a}),r=i.uuid}return n};function f(e,t,n){var r;let a=l(e.parentByChildUuid,t.uuid),u=l(e.childrenByParentUuid,a),o=i()((null!==(r=t.selectedOption)&&void 0!==r?r:0)+n,0,u.length-1);e.selectedChildByUuid.set(a,o);let s=m(e,a);return c(e,s[s.length-1].uuid)}},6700:function(e,t,n){n.d(t,{YZ:function(){return d},z$:function(){return c}});var r=n(28648),a=n(7653),i=n(83041),u=n(11492),o=n(16096),s=n(89937);let l={"ts.eu_election_banner.shown":{version:1,data_team_tag:"ts"},"ts.banner.shown":{version:1,data_team_tag:"ts"},"billing.credit_card.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.completed":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire_manual.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.completed":{version:1,data_team_tag:"billing_funnel"},"console.feedback.opened":{version:1},"console.feedback.submitted":{version:1},"evals.revision.created":{version:1},"evals.show_prompt_preview.toggled":{version:1},"evals.show_golden_answers.toggled":{version:1},"evals.run_all.submitted":{version:1},"evals.run_all.stopped":{version:1},"evals.test_case.run.submitted":{version:1},"evals.test_case.run.completed":{version:1},"evals.test_case.run.failed":{version:1},"evals.test_case.create.submitted":{version:1},"evals.test_case.delete.submitted":{version:1},"evals.select_revision.clicked":{version:1},"evals.test_case.update_rating.submitted":{version:1},"evals.test_case.import.show_modal.clicked":{version:1},"evals.test_case.import.browse.clicked":{version:1},"evals.test_case.import.success":{version:1},"evals.comparison.add_button.clicked":{version:1},"evals.comparison.remove_button.clicked":{version:1},"evals.comparison.other_revision.selected":{version:1},"test_case_generator.generate.started":{version:1},"test_case_generator.edit_logic.clicked":{version:1},"metaprompter.modal.loaded":{version:1},"metaprompter.example.selected":{version:1},"metaprompter.generate.started":{version:1},"metaprompter.generate.stop.attempted":{version:1},"metaprompter.generate.finished":{version:1},"metaprompter.start_editing.clicked":{version:1},"onboarding.invite_accept_page.invite_accept.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.invite_reject.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.submitted":{version:1,data_team_tag:"onboarding_funnel"},"workbench.completion.started":{version:1},"workbench.completion.finished":{version:1},"workbench.completion_stream.started":{version:1},"workbench.completion_stream.finished":{version:1},"workbench.tab_selection.clicked":{version:1},"workbench.variables_pane.loaded":{version:1},"workbench.examples.pane.loaded":{version:1},"workbench.examples.example.added":{version:1},"workbench.examples.example.deleted":{version:1},"workbench.examples.converted_to_raw_text":{version:1},"claudeai.projects.list_view.switched":{version:1},"claudeai.conversation.suggestion.applied":{version:1},"claudeai.conversation.recent.opened":{version:1},"claudeai.projects.activity.shared_conversation.opened":{version:1},"claudeai.conversation.artifact.vscode_exported":{version:1},"claudeai.settings.preview_feature.toggled":{version:1},"claudeai.settings.preview_feature.opened":{version:1},"claudeai.support.opened":{version:1},"claudeai.conversation.feedback.sent":{version:1},"ccos.chatsuggestion.clicked":{version:1},"ccos.chatsuggestions.loaded":{version:1},"ccos.chatsuggestions.feedback":{version:1},"artifact.feedback.sentiment":{version:1},"artifact.feedback.note":{version:1},"mcp.servers.listed":{version:1},"mcp.servers.connected":{version:1},"mcp.resources.listed":{version:1},"mcp.resources.read":{version:1},"mcp.prompts.listed":{version:1},"mcp.prompts.used":{version:1},"mcp.tools.listed":{version:1},"mcp.tools.called":{version:1},"hfi.comparative_model.selected":{version:1},"hfi.comparative_model.selection_cleared":{version:1},"hfi.comparative_model.streaming.started":{version:1},"hfi.comparative_model.streaming.finished":{version:1},"hfi.comparative_model.feedback_bar.switch_response.clicked":{version:1},"hfi.comparative_model.feedback_bar.prefer_response.clicked":{version:1}},c=()=>{let e=(0,s.K)(),{account:t,activeOrganization:n,isLoading:r}=(0,o.useCurrentAccount)(),i=(0,u.useIsClaudeDot)(),c=(0,a.useCallback)(a=>{if(r)return;let{event_key:u,...o}=a;return e.track(u,{account_uuid:null==t?void 0:t.uuid,organization_uuid:null==n?void 0:n.uuid,billing_type:null==n?void 0:n.billing_type,surface:i?"claude-ai":"console",...l[u],...o})},[e,t,n,i,r]);return(0,a.useMemo)(()=>({track:c}),[c])},d=(e,t,n,a)=>{let u=c(),{onSuccess:o,onError:s,...l}=a||{};return(0,i.uC)(t,n,{onSuccess(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];u.track({event_key:e,result:"success"}),null==o||o(...n)},onError(t){let n;for(var a=arguments.length,i=Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];t instanceof r.Hx&&(n=t.type),u.track({event_key:e,result:"failure",failure_reason:n}),null==s||s(t,...i)},...l})}},17179:function(e,t,n){n.d(t,{I:function(){return o},T:function(){return u}});var r=n(27573),a=n(7653);let i=(0,a.createContext)(null),u=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useCurrentConversationSettings must be used within a CurrentConversationSettingsProvider");return e},o=e=>{let{children:t,settings:n}=e;return(0,r.jsx)(i.Provider,{value:n,children:t})}},89937:function(e,t,n){n.d(t,{K:function(){return u}});var r=n(87050),a=n(11492),i=n(21728);let u=()=>{let{segmentKey:e,segmentCdnHost:t,segmentApiHost:n}=(0,a.useConfiguration)(),{value:u}=(0,r.F)("requires_explicit_consent");return i.u.loadIfNecessary({segmentKey:e,segmentCdnHost:t,segmentApiHost:n,requiresExplicitConsent:u})}},31087:function(e,t,n){n.d(t,{K:function(){return r}});let r=e=>{let t="";if(e.content)for(let n of e.content)"text"===n.type&&(t+=n.text);return t}},36665:function(e,t,n){n.d(t,{B:function(){return a}});var r=n(7653);function a(e){let t=JSON.stringify(e);return(0,r.useMemo)(()=>e,[t])}},28505:function(e,t,n){n.d(t,{H:function(){return r}});let r=()=>void 0===crypto.randomUUID?"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,e=>{let t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}):crypto.randomUUID()}}]);